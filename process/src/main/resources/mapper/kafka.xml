<?xml version="1.0"?>
<?xml-stylesheet type="text/xsl" href="configuration.xsl"?>
 
<!-- "&lt;"   : "<" -->
<!-- "&gt;"   : ">" -->
<!-- "&amp;"  : "&" -->
<!-- "&nbsp;" : " " -->
<!-- "&quot;" : "\"" -->
<!-- "&copy;" : "Â©" -->
<Mapper>
    <KafkaDDL>
        with 
        (
             'connector'                    = 'kafka', 
             'topic'                        = '${topic}', 
             'properties.bootstrap.servers' = '${kafkaServer}', 
             'properties.bootstrap.servers' = '${groupId}', 
             'format'                       = 'json', 
             'scan.startup.mode'            = 'group-offsets'
        )
    </KafkaDDL>
    
    <SinkDDL>
        with 
        ( 
            'connector'                    = 'kafka', 
            'topic'                        = '${topic}',
            'properties.bootstrap.servers' = '{kafkaServer}',
            'format'                       = 'json'
        )
    </SinkDDL>
    
    <UpsertDDL>
        with 
        ( 
            'connector'                    = 'upsert-kafka',
            'topic'                        = '${topic}',
            'properties.bootstrap.servers' = '{kafkaServer}',
            'key.format'                   = 'json', 
            'value.format'                 = 'json' 
        )
    </UpsertDDL>
    
    <GetTopicDb>
        create table topic_db 
        ( 
            `database` string, 
            `table`    string, 
            `type`     string, 
            `data`     map<string,string>, 
            `old`      map<string,string>, 
            `pt`       as proctime() 
        )
    </GetTopicDb>
</Mapper>
